<style>
  body {
    font-family: 'Inter', sans-serif;
  }
</style>

<body class="bg-black text-green-400 min-h-screen">
  <div class="min-h-screen bg-black text-green-400 p-6 sm:p-10 flex flex-col font-inter">
    <div class="max-w-7xl mx-auto w-full flex-grow flex flex-col space-y-10">

      <!-- Dashboard Header -->
      <header class="text-center sm:text-left">
        <h1 class="text-5xl font-extrabold drop-shadow-md mb-4">
          👤 Admin Dashboard
        </h1>
        <p class="text-green-300 text-sm">
          Welcome, <%= current_user.email %>! You are logged in as <%= current_user.role.capitalize %>.
        </p>
      </header>

      <!-- Search Users -->
      <section class="bg-gray-900 border border-green-700 rounded-xl p-6 shadow-md">
        <h2 class="text-2xl font-semibold mb-4 text-green-300">🔍 Search Users</h2>
        <%= search_form_for @q, url: admin_index_path, method: :get do |f| %>
          <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4">
            <div>
              <%= f.label :email_cont, "Search By Email", class: "block text-green-300 text-sm mb-1" %>
              <%= f.search_field :email_cont, class: "w-full p-2 rounded bg-gray-800 text-green-100 border border-green-600 focus:outline-none focus:ring-2 focus:ring-green-400" %>
            </div>
          </div>
          <%= f.submit "Search", class: "bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow-md transition" %>
        <% end %>
      </section>

      <!-- Create User -->
      <section class="bg-gray-900 border border-green-700 rounded-xl p-6 shadow-md">
        <h2 class="text-2xl font-semibold mb-4 text-green-300">➕ Create New User</h2>
        <%= form_with(model: User.new, url: admin_index_path, local: true, class: "space-y-4") do |f| %>
          <div>
            <%= f.label :email, "Email", class: "block text-green-300 text-sm mb-1" %>
            <%= f.email_field :email, required: true, class: "w-full p-2 rounded bg-gray-800 text-green-100 border border-green-600 focus:outline-none focus:ring-2 focus:ring-green-400" %>
          </div>

          <div>
            <%= f.label :password, "Password", class: "block text-green-300 text-sm mb-1" %>
            <%= f.password_field :password, required: true, class: "w-full p-2 rounded bg-gray-800 text-green-100 border border-green-600 focus:outline-none focus:ring-2 focus:ring-green-400" %>
          </div>

          <div>
            <%= f.label :password_confirmation, "Confirm Password", class: "block text-green-300 text-sm mb-1" %>
            <%= f.password_field :password_confirmation, required: true, class: "w-full p-2 rounded bg-gray-800 text-green-100 border border-green-600 focus:outline-none focus:ring-2 focus:ring-green-400" %>
          </div>

          <div>
            <%= f.label :role, "Role", class: "block text-green-300 text-sm mb-1" %>
            <%= f.select :role, options_for_select(['admin', 'standard']), {}, class: "w-full p-2 rounded bg-gray-800 text-green-100 border border-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 transition" %>
          </div>

          <%= f.submit "Create User", class: "bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow-md transition" %>
        <% end %>
      </section>

      <!-- Stats Cards -->
      <section class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
        <% stats = {
          "Total Users" => User.count,
          "New This Week" => User.where('created_at >= ?', 7.days.ago).count,
          "Admins" => User.where(role: 'admin').count
        } %>

        <% stats.each do |title, value| %>
          <div class="bg-gray-900 p-6 rounded-xl shadow-lg border border-green-700 text-center hover:shadow-green-500/70 transition">
            <p class="text-green-300 text-sm uppercase mb-2 tracking-wider font-semibold"><%= title %></p>
            <p class="text-4xl font-extrabold text-green-100"><%= value %></p>
          </div>
        <% end %>
      </section>

      <!-- Recently Created Users -->
      <section>
        <h2 class="text-3xl font-semibold text-green-400 mb-4">🆕 Recently Created Users</h2>
        <div class="overflow-x-auto bg-black border border-green-800 rounded-xl shadow-md">
          <table class="min-w-full divide-y divide-green-800 text-sm">
            <thead class="bg-black text-green-100 uppercase tracking-wider">
              <tr class="bg-black text-green-100">
                <th class="bg-black text-green-100 px-6 py-3 text-left">Email</th>
                <th class="bg-black text-green-100 px-6 py-3 text-left">Role</th>
                <th class="bg-black text-green-100 px-6 py-3 text-center">Suspended</th>
                <th class="bg-black text-green-100 px-6 py-3 text-center">Delete</th>
                <th class="bg-black text-green-100 px-6 py-3 text-left">Joined</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-green-800 text-green-300">
              <% User.order(created_at: :desc).limit(5).each do |user| %>
                <tr class="hover:bg-green-900 transition-colors">
                  <td class="px-6 py-3 truncate" title="<%= user.email %>"><%= user.email %></td>
                  <td class="px-6 py-3 capitalize font-medium text-center"><%= user.role %></td>
                  <td class="px-6 py-3 text-center"><%= user.suspended? ? "Yes" : "No" %></td>
                  <td class="px-6 py-3 text-center">
                    <%= link_to "Delete", admin_path(user), method: :delete, data: { turbo_confirm: "Are you sure you want to delete this user?" }, class: "text-red-500 hover:text-red-700 font-semibold" %>
                  </td>
                  <td class="px-6 py-3"><%= user.created_at.strftime("%b %d, %Y") %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Manage All Users -->
      <section>
        <h2 class="text-3xl font-semibold text-green-400 mb-4">⚙️ Manage All Users</h2>
        <div class="space-y-6">
          <% @users.each do |user| %>
            <%= form_for(user, url: admin_path(user), method: :patch, html: { class: "bg-gray-900 border border-green-700 rounded-xl p-6 shadow-lg hover:shadow-green-500/70 transition" }) do |f| %>
              <div class="grid grid-cols-1 md:grid-cols-4 gap-6 items-center">
                <p class="text-green-300 font-semibold truncate" title="<%= user.email %>">
                  Email: <span class="text-green-100"><%= user.email %></span>
                </p>
                <div>
                  <%= f.label :role, "Change Role", class: "block text-sm text-green-300 mb-1" %>
                  <%= f.select :role, options_for_select(['admin', 'standard'], user.role), {}, class: "w-full p-2 rounded bg-gray-800 text-green-100 border border-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 transition" %>
                </div>
                <div class="flex gap-3 justify-center md:justify-start">
                  <%= f.submit "Update", class: "bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow-md transition" %>
                  <%= link_to(user.suspended? ? "Unsuspend" : "Suspend", toggle_suspend_admin_path(user), method: :patch, data: { confirm: "Are you sure?" }, class: "bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-2 px-4 rounded shadow transition") %>
                </div>
                <div class="text-center md:text-left">
                  <%= link_to "Show & Delete", admin_path(user),class: "bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded shadow transition" %>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </section>

    </div>
  </div>
</body>
